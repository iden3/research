
%Our elements are of : 

%	, where 
%	$$ r = 	21888242871839275222246405745257275088548364400416034343698204186575808495617 $$
% The hash function used in the Merkle tree is MiMC-7 described in \cite{mimc}.\\
%[REF]. Original paper MiMC hash: \url{https://eprint.iacr.org/2016/492.pdf}.\\
The hash function used in EdDSA is MiMC-7 based in paper \cite{mimc}, which describes the hash using exponent 3. In this specification, we use exponent 7 (hence the name MiMC-7) as 3 and $l-1$ are not coprime and 7 is the optimal choice for exponentiation \cite[Sec. 6]{mimc}.\\

% and goes as follows: %is constructed as follows: 
%
Let $\Fl$ be the finite field with $l$ elements. The block cipher is constructed by iterating a round function $r$ times where each round consists of a key addition with the key $k$, the addition of a round constant $c_i\in \Fr$, and the application of a non-linear function defined as $F(x) :=x^7$ for $x\in \Fl$. The ciphertext is finally produced by adding the key $k$ again to the output of the last round. Hence, the round function is described as $F_i(x) = F(x) \xor k \xor c_i$ where $c_0 = c_r = 0$ and the encryption process is defined as 
	$$ 
		E_k(x) = (F_{r-1} \circ F_{r-2} \circ ... \circ F_0)(x) \xor k.
	$$


%. Instead the constants are fixed once and can be hard-coded into the implementation on either side. 


%The number of rounds is: 
%$$ \text{nRounds} = \ceil*{\frac{\llog r}{\llog 7}} = 91. $$\\

%% Esquema MIMC-7
\input{fig-mimc7.tex}

As the random  constants $c_i$ do  not  need  to  be  generated  for  every evaluation of MiMC-7, they are hard-coded into the implementation. The generation of these constants and the required number of rounds is described in section \ref{sec-mimc}. 
%
%The hash returns 140 bits, this is why Merkle trees are bounded by 140 levels (it is the length of the whole path of a claim). \\
%
%Encadenar valors (tipu pel hash de H(v1, v2, v3, v4) etc.\\
